Bootstrap: docker
From: eicweb.phy.anl.gov:4567/containers/eic_container/eic_container:latest

%help
  EIC software container.
  Tools:
     - root        : root version used for the analyzer
     - rootls, rootbrowse, root-config, hadd, h2root
     - dd4hep: ddeve, ddsim
     - genfit

%labels
  Maintainer "Whitney Armstrong"
  Version v1.0

%post -c /bin/bash
  echo " Image build is now mostly done in dockerfile"
  echo "  -------------------------------------------------"
  echo "  ===> Image setup complete"
  echo "  -------------------------------------------------"

# ===================================
# GLOBAL
# ===================================

%environment -c /bin/bash
  export PYTHONPATH=/usr/local/lib:$PYTHONPATH
  export PATH=/usr/loca/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include
  export EPICS_ROOT=/usr/local/epics
  export EPICS_BASE=/usr/local/epics/base
  export EPICS_HOST_ARCH=linux-x86_64
  export PATH=$EPICS_ROOT/bin:$PATH
  export LD_LIBRARY_PATH=$EPICS_ROOT/lib:$LD_LIBRARY_PATH
  export PATH=$EPICS_BASE/bin/$EPICS_HOST_ARCH:$PATH
  export LD_LIBRARY_PATH=$EPICS_BASE/lib/$EPICS_HOST_ARCH:$LD_LIBRARY_PATH

%runscript
  echo "Launching a shell in the Hall A/C container."
  echo "Use through singularity apps recommended (see help for more info)."
  exec bash

# ===================================
# ddsim
# ===================================
%apprun ddsim
  source /usr/local/bin/thisdd4hep.sh
  ddsim "%@"

%appenv ddsim
  export PYTHONPATH=/usr/local/lib:$PYTHONPATH
  export PATH=/usr/loca/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include

# =======================
# ddeve
# =======================
%apprun ddeve
  source /usr/local/bin/thisdd4hep.sh
  ddeve "$@"

%appenv ddeve
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana

# =======================
# root
# =======================
%apprun root
  source /usr/local/bin/thisdd4hep.sh
  root "$@"

%appenv root
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana
  export EPICS_ROOT=/usr/local/epics
  export EPICS_BASE=/usr/local/epics/base
  export EPICS_HOST_ARCH=linux-x86_64
  export PATH=$EPICS_ROOT/bin:$PATH
  export LD_LIBRARY_PATH=$EPICS_ROOT/lib:$LD_LIBRARY_PATH
  export PATH=$EPICS_BASE/bin/$EPICS_HOST_ARCH:$PATH
  export LD_LIBRARY_PATH=$EPICS_BASE/lib/$EPICS_HOST_ARCH:$LD_LIBRARY_PATH

# =======================
# root-config
# =======================
%apprun root-config
  source /usr/local/bin/thisdd4hep.sh
  root-config "$@"

%appenv root-config
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana


# =======================
# rootbrowse
# =======================
%apprun rootbrowse
  source /usr/local/bin/thisdd4hep.sh
  rootbrowse "$@"

%appenv rootbrowse
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana

# =======================
# rootls
# =======================
%apprun rootls
  source /usr/local/bin/thisdd4hep.sh
  rootls "$@"

%appenv rootls
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana

# =======================
# hadd
# =======================
%apprun hadd
  source /usr/local/bin/thisdd4hep.sh
  hadd "$@"

%appenv hadd
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana

# =======================
# h2root
# =======================
%apprun h2root
  source /usr/local/bin/thisdd4hep.sh
  h2root "$@"

%appenv h2root
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana

# =======================
# xml2evio
# =======================
%apprun xml2evio
  source /usr/local/bin/thisdd4hep.sh
  xml2evio "$@"

%appenv xml2evio
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana

# =======================
# evio2xml
# =======================
%apprun evio2xml
  evio2xml "$@"

%appenv evio2xml
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana

# =======================
# evioCat
# =======================
%apprun evioCat
  source /usr/local/bin/thisdd4hep.sh
  evioCat "$@"

%appenv evioCat
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana

# =======================
# eviocopy
# =======================
%apprun eviocopy
  eviocopy "$@"

%appenv eviocopy
  export PYTHONPATH=/usr/local/lib:${PYTHONPATH}
  export PATH=/usr/local/bin:${PATH}
  export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
  export ROOT_INCLUDE_PATH=/usr/local/include/podd:/usr/local/include/hcana
